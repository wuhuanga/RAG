8.3 星载数据管理

8.3    星载数据管理
8.3.1 系 统 概 况
中国卫星测控系统最初是由独立的遥测分系统、遥控分系统和跟踪定位分系统组成的，20 世纪80年代实现了射频载波的统一利用，即上述分系统射频信道合并为一台公用的测控应答 机，使用同一个载波信道。独立的遥测分系统和遥控分系统只能分别实现较为局限的卫星遥 测、遥控功能，而星上其他信息处理的功能，例如程控等功能则需另行设计。
20世纪70年代后期由于电子技术和计算机技术的飞速发展，星载微处理器的逐步完善，
卫星测控技术有了根本性变化，遥测、遥控的视频部分综合在一起，还综合了卫星其他信息处  理的功能，形成了以微处理器为核心的星载数据管理系统。20世纪80年代初，ESA 和 NASA  分别开发了星载数据管理系统(OBDH:On-Board  Data  Handing)和指令数据管理系统(C&DH:    Command &Data Handling)。目前许多大型卫星遥测路数将近千路，遥控指令条数将近五百条， 过去靠电缆网将被测或被控对象一对一地与遥测、遥控视频设备连接，电缆网接插件不仅占用 大量体积、质量，降低可靠性，而且电磁兼容性难度大。采用了在被测、被控对象附近设置远置  单元后，通过总线与星载计算机中央单元连接，所组成的星载数据管理系统将卫星的遥测、遥  控、程控、星载自主控制、校时、整星控制和管理等功能综合在一个以微处理机为主的系统中去  实现。与相互独立的几个分系统比较，数管系统能对卫星的测控信息进行综合的管理和利用， 做到信息共享，从而更有效、更合理；对实现上述功能的硬件、软件、接口、通信等从系统、部件、 电路甚至到器件各个方面，不同层次上都进行了综合设计(除了部件、电路、器件一级的冗余设  计外，还从系统一级进行了冗余和容错设计),达到资源共享，并力求做到交互支持，避免了重  复备份，从而更经济、更可靠。
经串行数据总线SDB 将中央单元和多个远置单元以及远置总线接口相连接，数管系统又 将卫星的指令分配、数据采集和数据处理功能分配到多个分散配置的模块，甚至是到不同的分 系统中去实现。这与集中式的系统比较，简化了接口设计、数据传输、软件开发和测试，不仅有 利于模块化设计，能方便地进行功能、通道的扩充和重新配置、满足不同卫星的不同需求，又有 利于实现并行和自治运行的分布式处理、故障隔离和容错设计，提高卫星的可靠性。这是卫星 测控的重大变革，也是卫星总体电路设计的重大变革。
数管系统设计中，注重部件功能及接口一级的规范化和标准化，减少了重复开发和验证工 作；硬件、软件、验证、测试等都可以多次使用，既节省了开发、制造的经费和培训工作，又缩短 了研制新型号的周期；同时，还保留了足够的发展空间，以便于不断地采纳最新的技术成果。
8.3.2  功能和原理
星载数据管理系统的主要功能如下：
1)接收、解调和处理来自射频信道中遥控副载波的上行遥控指令和数据，完成解调、解码 以及指令验证等功能，并将指令和数据分配到星上各分系统。
2)采集卫星平台和有效载荷各分系统的遥测数据，进行处理、存储并汇集所有需经遥测下 行信道传送的信息，实施格式化包装处理；在完成信道编码和副载波调制后送至遥测下行射频 信道传送。
3)提供星载有关分系统信息处理和测控功能，如发送整星预置(或注入)程序的程控指令， 延时指令，主动温度控制，设备参数(被测)报警，主备份切换等星内系统的自主控制和管 理 。
4)产生星上时间基准信号和时钟，向各分系统分配时间信息和定时信号，为分系统提供事 件计时，并可按地面标准时间进行星上时间的校时。
5)实施星内各计算机之间信息联网和交互支持。
6)完成星上有关的信息处理任务，例如进行轨道计算；按任务要求计算有效载荷开关机时 间等。
7)为星上有关分系统提供专用的数据处理和数据格式，支持各分系统间的信息交换和信 息共享。例如将与遥感信息有关的数据(轨道、姿态等)插入到遥感信息数据中，存储各分系统 特别是控制系统的重要数据。在某些必要情况下，可直接分析或参与某些系统的信息处理或 自主管理任务。
8)实现卫星的状态管理，可在外部干预以及自主方式下运行。卫星在地面进行各种大型 试验以及卫星轨道运行各种不同状态中，实现工作状态管理。
OBDH原理如框图8-8所示。遥控单元接收来自星载测控应答机中的接收机输出的遥 控副载波，通过解调、译码、分路输出直接指令(有时一个单元不够，还可附加一个至多个译码， 分路设备);其中串行的加载指令和间接开关指令由遥控单元等送入中央单元。中央单元通过 验证所接收到的遥控数据块的有效性进行分路，再经串行总线送到远置单元，由远置单元再送  到各被控对象。
图 8 - 8 OBDH原理框图
远置单元采集各被测对象的遥测数据以及某些分系统需下行传输的数据。在此单元内编 码并形成格式化的数字数据流，通过串行总线送入中央单元；在此集合各远置单元的数据形成 遥测帧、遥测格式，必要时还需形成遥测包，并实施信道编码、副载波调制，并将副载波信号送 到测控应答机的发射机入口处。
为了提高遥控指令的可靠性，在星载数管系统中安排了单独的遥控单元及其附加设备(指 令译码单元)。它独立于星载计算机系统之外，也可像远置单元那样，置于被控对象附近，直接 指令就近送到被控设备入口。它不通过计算机，使特别重要的指令即使在计算机失效情况下 也能正常工作。通常遥控单元安置在卫星平台，为平台各分系统提供直接指令。另一个附加 的指令译码单元安置在卫星有效载荷舱，为各有效载荷提供直接指令。
星载数据管理需要有存储功能，因此在数据总线上挂有大容量存储器。
8.3.3 软件设计与工程化
OBDH中 CTU,RTU,SDB等硬件是基础，而软件是灵魂，它决定了系统的先进性、可靠性、 实时性、实用性等。优秀的软件不但能充分发挥航天器硬件的作用，确保数管系统功能的完成  并达到设计指标，还能在某些不利的条件下，如卫星运行状态偏离设计状态，卫星硬件(包括卫  星 OBDH 硬件、甚至其他分系统硬件)发生个别故障情况下，尽可能地保证卫星的正常运行。
这就是在软件设计中包括了系统重构、设备重组、容错。
OBDH 软件应具有的基本特点是：
1)具有实时性、自治性和确保运行的安全。特别对于有些卫星不常在地面监视下，OBDH 软件设计要求能实时进行故障判别，及时采取措施。这是十分重要的。
2)具有在轨飞行中的可维护、可重编程能力。 OBDH  的 ROM  中仅装载重要的程序和数 据，由于实际轨道运行中发生的情况千差万别，地面站依据地面判别的情况，经上行信道注入 到卫星数管系统RAM 中运行。 OBDH的软件具有灵活性，可以更改并实现在轨维护。
3)具有标准化、模块化的特点，易于剪裁。不同卫星虽然任务不同，具有各自特性，但也具 有大量相似的系统功能。 OBDH 软件采用标准化设计，通过不同剪裁可以适应各种卫星的要 求，软件的标准化、模块化设计，大大提高了可靠性。
采用总线结构的OBDH 一般为二级的分布式计算机系统，其中软件可分为CTU 运行的管 理软件和CTU运行的执行软件。 CTU运行的管理软件又可分为两个层次，即核和应用软件如 图 8 - 9 所 示 。 图 8 - 9(b) 表示采用四层结构的软件：第一层面向硬件，取决于硬件结构和配 置，提供硬件管理和接口驱动程序；第二层为实时操作系统，实施软件调度并提供系统调用，可 采用商业产品；第三层为基本服务软件，包括监控、数据传输、文件传输、命令处理等；第四层是 与具体飞行任务有关的专用软件，从简单的命令处理到复杂的数据处理。
(a)                                                            (b)
图 8 - 9 CTU软件结构
核和应用软件是硬件接口的基础软件， 一般设计为专用的实时多任务操作系统。实际的 处理机被扩充为多个虚拟机，能“实时”、“并行”地处理多个任务，系统响应的实时性和多任务 运行是其特点。操作系统软件管理 CTU计算机的各种资源，控制对不同任务的资源分配。其 基本功能包括任务调度，时间管理，中断处理，输入输出设备管理，其他外设的驱动，计算机系 统的自测试、自诊断以及冗余和容错管理等。模块化设计包括系统初始化模块，中断处理模 块，输入输出端口管理和驱动模块，自测试、自诊断模块，内存管理模块等。操作系统在目前一 般由汇编语言编写，可以做到程序结构紧凑，运行效率高。
应用软件包括飞行任务数据处理软件和系统管理软件。飞行任务数据处理软件要采集、 接收和处理大量的数据，包括卫星飞行中获取到的数据和地面站传送来的数据。其数据处理  的要求依不同的飞行任务而异。系统管理软件包括故障检测和校正，长周期持续事件的调度  (如卫星在阴影区时太阳电池不发电，靠蓄电池供电，这种电源系统的状态变化),有效载荷的  管理等。 一般可按软件结构和功能需求划分为若干个进程，实现不同的功能，如：上行遥控数
据处理和分配进程，工程遥测数据采集和处理进程，延时遥测数据压缩进程，下行遥测数据生  成进程，程序控制进程，热控、供电监控等自主控制进程，专用数据处理进程，辅助数据生成和  发送进程，内务管理进程，程序加载进程等。配置不同的进程，有利于开发和维护，易于满足不  同卫星的需求。应用软件可用高级语言编写，具有易于测试和维护，生存期长成本低的优点； PASCAL语言，C 语言，ADA语言都在选用之列。